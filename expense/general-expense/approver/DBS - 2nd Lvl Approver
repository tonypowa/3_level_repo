-- This script collects a list of Users and their 2nd lvl assigned approver.

SELECT LAN.VALUE AS 'USER GROUP', EMP.FIRST_NAME AS 'USER FIRST NAME', EMP.LAST_NAME AS 'USER LAST NAME', EMP.EMP_ID AS 'USER EMPLOYEE ID',EMP.EMAIL_ADDRESS AS 'USER EMAIL ADDRESS',EMP.LOGIN_ID AS 'USER LOGIN ID',APPR.FIRST_NAME AS 'APPROVER FIRST NAME', APPR.LAST_NAME AS 'APPROVER LAST NAME', APPR.EMP_ID AS 'APPROVER EMPLOYEE ID',APPR.EMAIL_ADDRESS AS 'APPROVER EMAIL ADDRESS',APPR.LOGIN_ID AS 'APPROVER LOGIN ID'  
  FROM CT_EMPLOYEE EMP  
JOIN CT_WORKFLOW_SUBJECT_EMP_MAP WSE ON EMP.EMP_KEY = WSE.EMP_KEY  
JOIN CT_WORKFLOW_EMP_AUTH_MAP WEA ON WSE.WSE_KEY = WEA.WSE_KEY  
JOIN CT_EMPLOYEE APPR ON WEA.AUTH_EMP_KEY = APPR.EMP_KEY  
JOIN CT_LIST_ITEM_LANG LAN ON EMP.CUSTOM21 = LAN.LI_KEY 
WHERE WSE.SUBJECT_CODE = 'REPORT'  
  AND EMP.IS_TEST_EMP = 'N'  
  AND EMP.ACTIVE = 'Y'  
  AND WEA.SEQUENCE = '2' 
  AND LAN.LANG_CODE = 'en'
